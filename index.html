<!DOCTYPE html>
<html>
  <head>
    <script src="https://code.jquery.com/jquery-3.6.3.slim.min.js"></script>
  </head>
  <body>
    <button onclick="generate()">Generate wallet address</button>
    <br /><br />
    <input id="addr" size="50" placeholder="Enter wallet address" />
    <button onclick="balance()">Check balance</button><br /><br />
    <input id="amt" value="300" />
    <button onclick="transfer()">Transfer</button>
    <pre></pre>
  </body>
  <script>
    const API = {
        'Content-Type': 'application/json',
        'x-api-key': 'f1384f0e-abd1-4d69-bb64-4682beb7fde4',
      },
      CHAIN = 'BSC',
      BEP20 = '0x86a3cA85fb4F1dB9028AF609036a4f8DA74A2458',
      KEY =
        '0x4dff39920956c6c23e259c0a674e4b405df0b7b3808e0165a05348b4e07afddc';

    async function generate() {
      resp = await fetch(`https://api.tatum.io/v3/${CHAIN}/wallet`, {
        method: 'GET',
        headers: API,
      });
      data = JSON.parse(await resp.text());
      $('pre').append(JSON.stringify(data, null, '\t'));
      resp = await fetch(`https://api.tatum.io/v3/${CHAIN}/wallet/priv`, {
        method: 'POST',
        headers: API,
        body: JSON.stringify({
          index: 0,
          mnemonic: data.mnemonic,
        }),
      });
      $('pre').append(
        JSON.stringify(JSON.parse(await resp.text()), null, '\t')
      );
      resp = await fetch(
        `https://api.tatum.io/v3/${CHAIN}/address/${data.xpub}/${1}`,
        {
          method: 'GET',
          headers: API,
        }
      );
      $('pre').append(
        JSON.stringify(JSON.parse(await resp.text()), null, '\t')
      );
    }

    async function balance() {
      address = $('#addr').val();
      resp = await fetch(
        `https://api.tatum.io/v3/blockchain/token/balance/${CHAIN}/${BEP20}/${address}`,
        {
          method: 'GET',
          headers: API,
        }
      );
      $('pre').append(
        JSON.stringify(JSON.parse(await resp.text()), null, '\t')
      );
    }

    async function transfer() {
      resp = await fetch(
        `https://api.tatum.io/v3/blockchain/token/transaction`,
        {
          method: 'POST',
          headers: API,
          body: JSON.stringify({
            chain: CHAIN,
            to: $('#addr').val(),
            contractAddress: BEP20,
            amount: $('#amt').val(),
            digits: 18,
            fromPrivateKey: KEY,
          }),
        }
      );
      $('pre').append(
        JSON.stringify(JSON.parse(await resp.text()), null, '\t')
      );
    }
  </script>
</html>
