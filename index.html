<!DOCTYPE html>
<html>
  <head>
    <script src="https://code.jquery.com/jquery-3.6.3.slim.min.js"></script>
  </head>
  <body>
    <button onclick="generate()">Generate wallet address</button>
    <br /><br />
    <input id="addr" size="50" placeholder="Enter wallet address" />
    <button onclick="balance()">Check balance</button>
    <button onclick="transfer()">Transfer</button>
    <pre></pre>
  </body>
  <script defer>
    api = 'f1384f0e-abd1-4d69-bb64-4682beb7fde4';
    contractAddr = '0x86a3cA85fb4F1dB9028AF609036a4f8DA74A2458';

    async function generate() {
      resp = await fetch(`https://api.tatum.io/v3/BSC/wallet`, {
        method: 'GET',
        headers: {
          'x-api-key': api,
        },
      });
      data = JSON.parse(await resp.text());
      $('pre').append(JSON.stringify(data, null, '\t'));
      resp = await fetch(
        `https://api.tatum.io/v3/BSC/address/${data.xpub}/${1}`,
        {
          method: 'GET',
          headers: {
            'x-api-key': api,
          },
        }
      );
      data = JSON.parse(await resp.text());
      $('pre').append(JSON.stringify(data, null, '\t'));
    }

    async function balance() {
      address = $('#addr').val();
      resp = await fetch(
        `https://api.tatum.io/v3/blockchain/token/balance/BSC/${contractAddr}/${address}`,
        {
          method: 'GET',
          headers: {
            'x-api-key': api,
          },
        }
      );
      data = JSON.parse(await resp.text());
      $('pre').append(JSON.stringify(data, null, '\t'));
    }

    async function transfer() {
      resp = await fetch(
        `https://api.tatum.io/v3/blockchain/token/transaction`,
        {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'x-api-key': api,
          },
          body: JSON.stringify({
            chain: 'BSC',
            to: $('#addr').val(),
            contractAddress: contractAddr,
            amount: '300',
            digits: 18,
            fromPrivateKey:
              '0x4dff39920956c6c23e259c0a674e4b405df0b7b3808e0165a05348b4e07afddc',
          }),
        }
      );
      data = JSON.parse(await resp.text());
      $('pre').append(JSON.stringify(data, null, '\t'));
    }
  </script>
</html>
